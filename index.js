var __extends = this && this.__extends || function () { var t = function (r, o) { return (t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, r) { t.__proto__ = r } || function (t, r) { for (var o in r) Object.prototype.hasOwnProperty.call(r, o) && (t[o] = r[o]) })(r, o) }; return function (r, o) { if ("function" != typeof o && null !== o) throw new TypeError("Class extends value " + String(o) + " is not a constructor or null"); function e() { this.constructor = r } t(r, o), r.prototype = null === o ? Object.create(o) : (e.prototype = o.prototype, new e) } }(); !function (t) { var r = new (function (t) { function r(r) { var o = t.call(this, r) || this; return o.matrix = [], o.matrixScale = 20, o.matrixColor = "#000", o.foodColor = "#0f0", o.foodCoord = { x: -1, y: -1 }, o.playerColor = "#f00", o.playerScore = 0, o.playerLength = 5, o.playerCoords = [], o.playerDir = "right", o.canvas && (o.width = o.canvas.width = Math.floor(document.body.offsetWidth / o.matrixScale), o.height = o.canvas.height = Math.floor(document.body.offsetHeight / o.matrixScale), o.start()), o } return __extends(r, t), r.prototype.createMatrix = function () { this.matrix = []; for (var t = 0; t < this.height; t++) { this.matrix.push([]); for (var r = 0; r < this.width; r++)this.matrix[t].push(0) } }, r.prototype.drawMatrix = function () { for (var t = 0; t < this.height; t++)for (var r = 0; r < this.width; r++) { var o = this.matrix[t][r]; 1 === o ? (this.core.fillStyle = this.playerColor, this.core.fillRect(r, t, 1, 1)) : 2 === o ? (this.core.fillStyle = this.foodColor, this.core.fillRect(r, t, 1, 1)) : (this.core.fillStyle = this.matrixColor, this.core.fillRect(r, t, 1, 1)) } }, r.prototype.createPlayerCoords = function () { for (var t = 0; t < this.playerLength; t++)this.playerCoords.push({ x: t, y: 0 }) }, r.prototype.writePlayerCoords = function () { for (var t = 0; t < this.playerLength; t++) { var r = this.playerCoords[t]; this.matrix[r.y][r.x] = 1 } }, r.prototype.clearPlayerCoord = function (t) { var r = this.playerCoords[t]; this.playerCoords.splice(t, 1), this.matrix[r.y][r.x] = 0 }, r.prototype.writeFoodCoord = function () { for (var t = [], r = 0; r < this.height; r++)for (var o = 0; o < this.width; o++)0 === this.matrix[r][o] && t.push({ x: o, y: r }); this.foodCoord = t[Math.floor(Math.random() * t.length)], this.matrix[this.foodCoord.y][this.foodCoord.x] = 2 }, r.prototype.updatePlayerCoords = function () { if (this.canvas) { var t = this.playerCoords[this.playerCoords.length - 1]; "right" === this.playerDir ? this.playerCoords.push({ x: t.x + 1, y: t.y }) : "left" === this.playerDir ? this.playerCoords.push({ x: t.x - 1, y: t.y }) : "up" === this.playerDir ? this.playerCoords.push({ x: t.x, y: t.y - 1 }) : "down" === this.playerDir && this.playerCoords.push({ x: t.x, y: t.y + 1 }), this.checkPlayerGameover() ? this.reset() : (this.checkPlayerEatFood(), this.writePlayerCoords(), this.drawMatrix()) } }, r.prototype.checkPlayerGameover = function () { var t = this.playerCoords[this.playerCoords.length - 1]; if (void 0 === this.matrix[t.y] || void 0 === this.matrix[t.y][t.x]) return !0; var r = this.playerCoords.map(function (t, r) { return JSON.stringify(t) }); return new Set(r).size < this.playerCoords.length }, r.prototype.checkPlayerEatFood = function () { var t = this.playerCoords[this.playerCoords.length - 1]; t.x === this.foodCoord.x && t.y === this.foodCoord.y ? (this.playerScore += 1, this.playerScore % 5 == 0 ? this.playerLength += 1 : this.clearPlayerCoord(0), this.writeFoodCoord()) : this.clearPlayerCoord(0) }, r.prototype.reset = function () { this.playerScore = 0, this.playerLength = 5, this.playerCoords = [], this.playerDir = "right", this.start() }, r.prototype.start = function () { this.createMatrix(), this.createPlayerCoords(), this.writePlayerCoords(), this.writeFoodCoord(), this.drawMatrix() }, r }(function () { return function (r) { this.device = "", this.canvas = null, this.core = null, this.width = 0, this.height = 0; var o = document.querySelector(r); o && o.constructor === HTMLCanvasElement ? (this.width = o.width = document.body.offsetWidth, this.height = o.height = document.body.offsetHeight, this.canvas = o, this.core = o.getContext("2d"), this.device = /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent || navigator.vendor || t.opera) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent || navigator.vendor || t.opera) ? "mobile" : "pc") : console.error(new Error("".concat(r, " is not a canvas element"))) } }()))("canvas"), o = "pc" === r.device ? 5 : 10, e = 0; function i() { (e += 1) > o && (e = 0, r.updatePlayerCoords()), requestAnimationFrame(i) } var a = { x: 0, y: 0 }, s = { x: 0, y: 0 }; t.addEventListener("load", function () { r.canvas && i(), "pc" === r.device ? t.addEventListener("keydown", function (t) { switch (t.key) { case "ArrowUp": "down" !== r.playerDir && (r.playerDir = "up", r.updatePlayerCoords()); break; case "ArrowDown": "up" !== r.playerDir && (r.playerDir = "down", r.updatePlayerCoords()); break; case "ArrowLeft": "right" !== r.playerDir && (r.playerDir = "left", r.updatePlayerCoords()); break; case "ArrowRight": "left" !== r.playerDir && (r.playerDir = "right", r.updatePlayerCoords()) } }) : "mobile" === r.device && (t.addEventListener("touchstart", function (t) { a.x = t.touches[0].clientX, a.y = t.touches[0].clientY }), t.addEventListener("touchmove", function (t) { s.x = t.touches[0].clientX, s.y = t.touches[0].clientY }), t.addEventListener("touchend", function () { var t = Math.abs(s.x - a.x), o = Math.abs(s.y - a.y); t > o ? s.x > a.x ? "left" !== r.playerDir && (r.playerDir = "right", r.updatePlayerCoords()) : s.x < a.x && "right" !== r.playerDir && (r.playerDir = "left", r.updatePlayerCoords()) : o > t && (s.y > a.y ? "up" !== r.playerDir && (r.playerDir = "down", r.updatePlayerCoords()) : s.y < a.y && "down" !== r.playerDir && (r.playerDir = "up", r.updatePlayerCoords())) })) }) }(globalThis);